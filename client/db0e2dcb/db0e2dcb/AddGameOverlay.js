(window.webpackJsonp=window.webpackJsonp||[]).push([[36],{4656:function(e,t,o){"use strict";var a=o(0);o(9),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,n,d,i,l,s,u,p=a(o(6)),m=a(o(15)),f=o(14),c=a(o(12)),g=a(o(3)),y=(a(o(13)),a(o(42))),b=a(o(35)),h=a(o(341)),O=a(o(586)),v=a(o(18)),I=a(o(71)),G=a(o(230)),w=a(o(38)),C=a(o(201)),S=a(o(22)),j=a(o(60)),x=a(o(114)),F=a(o(367)),P=a(o(50)),D=a(o(273)),A=o(747),T=a(o(25)),L=a(o(204)),V=a(o(1)),_=o(2),z=o(4);function k(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,a)}return o}function K(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?k(Object(o),!0).forEach((function(t){(0,m.default)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):k(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}var N=(0,a(o(10)).default)({name:"AddGameOverlay",loader:()=>o(9459)})(r=(0,L.default)(r=(0,S.default)(r=(0,T.default)(r=(0,z.observer)((n=class extends V.default.Component{constructor(...e){var t;super(...e),t=this,this.ControlConfiguration=D.default.ConfirmAndCancel,this.IsContentScrollable=!1,(0,c.default)(this,"formValue",d,this),(0,c.default)(this,"addedGameId",i,this),(0,c.default)(this,"isLoading",l,this),this.Confirm=(0,f.coroutine)((function*(){var e,o;const{teamId:a,teamInfo:r}=t.teamContext,{userTeams:n}=t.userContext,{addedGameId:d}=t;return r.addGame({gameId:d}),null==n||null===(e=n.find(e=>e.id===r.id))||void 0===e||e.addGame({gameId:d}),G.default.Tab.navigate({teamId:a,gameName:null===(o=j.default.get(d))||void 0===o?void 0:o.codeFriendlyName}),!v.default.IsDesktop&&w.default.emit(I.default.CloseMobileSlideNavOverflow),w.default.emit(C.default.Team,{teamId:a}),{addedGame:d}})),(0,c.default)(this,"ConfirmOverride",s,this),this.Header="Add a game",(0,c.default)(this,"_handleChange",u,this)}get ConfirmText(){const{gameFormSpecs:e}=this;return e?"Add game info":"Add game"}get selectedGame(){const{formValue:e}=this;return e&&j.default.get(e.values.game)}get gameFormSpecs(){const{addedGameId:e}=this;if(!e)return null;const t=O.default.GetAdditionalGameInfoFormSpecs({teamInfo:{additionalGameInfo:{}},gameInfo:j.default.get(e)});return t?{sections:[{fieldSpecs:t.map(e=>K(K({},(0,A.convertLegacyFieldSpec)(e)),{},{constrainWidth:!0}))}]}:null}get Disabled(){return!this.formValue||!this.formValue.isValid||this.isLoading}get existingGameIds(){const{teamInfo:e}=this.teamContext,{existingGameIds:t}=this.props;return t||(null==e?void 0:e.games.map(e=>e.id))}get formSpecs(){const{teamInfo:e}=this.teamContext,{existingGameIds:t,gameFormSpecs:o}=this;return o||{header:e?"Add a game to ".concat(e.name):"Add a game",sections:[{fieldSpecs:[K(K({},F.default.GetAddGameFieldSpec({gameIdsToExclude:t})),{},{fieldName:"game"})]}]}}get formKey(){const{gameFormSpecs:e,addedGameId:t}=this;return e&&t||"default"}render(){const{formSpecs:e,formKey:t}=this;return(0,p.default)(x.default,{formSpecs:e,onChange:this._handleChange,autoFocus:!0},t)}},d=(0,g.default)(n.prototype,"formValue",[_.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),i=(0,g.default)(n.prototype,"addedGameId",[_.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),l=(0,g.default)(n.prototype,"isLoading",[_.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),(0,g.default)(n.prototype,"ConfirmText",[_.computed],Object.getOwnPropertyDescriptor(n.prototype,"ConfirmText"),n.prototype),s=(0,g.default)(n.prototype,"ConfirmOverride",[_.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return(0,f.coroutine)((function*(){const{selectedGame:t,formValue:o,addedGameId:a}=e,{ae:r}=e.userContext,{teamId:n}=e.teamContext;if(e.isLoading=!0,a){Object.values((null==o?void 0:o.values)||{}).filter(Boolean).length>0&&(yield P.default.UpdateTeam({teamId:n,gameId:a,additionalGameInfo:{[a]:h.default.GetFilterQueryFromFormFields(o.values)}}),y.default.Log(b.default.TeamGameInfoAdded)),e.props.onConfirm()}else{e.addedGameId=t.id,yield P.default.UpdateTeam({teamId:n,addedGameId:t.id}),y.default.Log(b.default.TeamGameAdded);const{gameFormSpecs:o}=e;o?(0,_.runInAction)(()=>e.isLoading=!1):e.props.onConfirm()}}))}}),(0,g.default)(n.prototype,"selectedGame",[_.computed],Object.getOwnPropertyDescriptor(n.prototype,"selectedGame"),n.prototype),(0,g.default)(n.prototype,"gameFormSpecs",[_.computed],Object.getOwnPropertyDescriptor(n.prototype,"gameFormSpecs"),n.prototype),(0,g.default)(n.prototype,"Disabled",[_.computed],Object.getOwnPropertyDescriptor(n.prototype,"Disabled"),n.prototype),(0,g.default)(n.prototype,"existingGameIds",[_.computed],Object.getOwnPropertyDescriptor(n.prototype,"existingGameIds"),n.prototype),(0,g.default)(n.prototype,"formSpecs",[_.computed],Object.getOwnPropertyDescriptor(n.prototype,"formSpecs"),n.prototype),(0,g.default)(n.prototype,"formKey",[_.computed],Object.getOwnPropertyDescriptor(n.prototype,"formKey"),n.prototype),u=(0,g.default)(n.prototype,"_handleChange",[_.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>this.formValue=e}}),r=n))||r)||r)||r)||r)||r;t.default=N},9459:function(e,t,o){var a=o(7),r=o(9460);"string"==typeof(r=r.__esModule?r.default:r)&&(r=[[e.i,r,""]]);var n,d=0,i={injectType:"lazyStyleTag",insert:"head",singleton:!1},l={};r.locals&&(l.locals=r.locals),l.use=function(e){return d++||(n=a(r,{...i,...e})),l},l.unuse=function(){d>0&&!--d&&(n(),n=null)},e.exports=l},9460:function(e,t,o){(t=o(8)(!1)).push([e.i,".AddGameOverlay-container{padding:5px 30px}",""]),e.exports=t}}]);
//# sourceMappingURL=https://sourcemaps.local.guilded.gg/db0e2dcb/AddGameOverlay.js.map